/*!
    Title: Dev Portfolio Template
    Version: 1.2.2
    Last Change: 03/25/2020
    Author: Ryan Fitzgerald
    Repo: https://github.com/RyanFitzgerald/devportfolio-template
    Issues: https://github.com/RyanFitzgerald/devportfolio-template/issues

    Description: This file contains all the scripts associated with the single-page
    portfolio website.
*/
! function(n) {
    n("html").removeClass("no-js"), 
    n("header a").click(function(e) {
        if (!n(this).hasClass("no-scroll")) {
            e.preventDefault();
            var t = n(this).attr("href"),
                i = n(t).offset().top;
            n("html, body").animate({
                scrollTop: i + "px"
            }, +Math.abs(window.pageYOffset - n(t).offset().top)), n("header").hasClass("active") && n("header, body").removeClass("active")
        }
    }), n("#to-top").click(function() {
        n("html, body").animate({
            scrollTop: 0
        }, 500)
    }), n("#lead-down span").click(function() {
        var e = n("#lead").next().offset().top;
        n("html, body").animate({
            scrollTop: e + "px"
        }, 500)
    }), n("#experience-timeline").each(function() {
        $this = n(this), $userContent = $this.children("div"), $userContent.each(function() {
            n(this).addClass("vtimeline-content").wrap('<div class="vtimeline-point"><div class="vtimeline-block"></div></div>')
        }), $this.find(".vtimeline-point").each(function() {
            n(this).prepend('<div class="vtimeline-icon"><i class="fa fa-map-marker"></i></div>')
        }), $this.find(".vtimeline-content").each(function() {
            var e = n(this).data("date");
            e && n(this).parent().prepend('<span class="vtimeline-date">' + e + "</span>")
        })
    }), n("#mobile-menu-open").click(function() {
        n("header, body").addClass("active")
    }), n("#mobile-menu-close").click(function() {
        n("header, body").removeClass("active")
    }), n("#view-more-projects").click(function(e) {
        e.preventDefault(), n(this).fadeOut(300, function() {
            n("#more-projects").fadeIn(300)
        })
    }), n(".project-image").each(function(e) {
        console.log("> ",e, typeof(e), $( this )[0].children);
        // $( this )[0].style.height="200px";
        
        $( this )[0].children[0].width = 300;
        $( this )[0].children[0].style.marginLeft = "-100px";
        $( this )[0].children[0].style.marginTop = (-100).toString()+"px";
        console.log("> ",e, typeof(e), $( this )[0].children);
    })
}(jQuery),
getTop = el => el.offsetTop + (el.offsetParent && getTop(el.offsetParent))
function scaleVal(value, sourceRangeMin, sourceRangeMax, targetRangeMin, targetRangeMax) {
    var targetRange = targetRangeMax - targetRangeMin;
    var sourceRange = sourceRangeMax - sourceRangeMin;
    return (value - sourceRangeMin) * targetRange / sourceRange + targetRangeMin;
}
$(function () {
  $(window).scroll(function() {
    po=parseInt(window.pageYOffset);
    ph=parseInt(window.innerHeight);
    off=po+(ph-300)/2;
    f=400;
    console.log("> scroll > "+ off, (ph-300)/2);
    allimgs=document.getElementsByClassName("project-image");
    // console.log(typeof(allimgs.length));
    for (let i =0; i < allimgs.length; i++) {
            im=allimgs[i];
            // console.log(getTop(allimgs[i])-off);
            val=(getTop(im)-off);
            sval= Math.pow(scaleVal(val,0,300+(ph-300)/2,0,1),3);
            if(i==0)console.log(sval);
            im.children[0].width=300+(2*f*Math.abs(sval));
            im.children[0].style.marginLeft = Math.abs(sval)*(-f)+"px";
            im.children[0].style.marginTop = Math.abs(sval)*(-f)+"px";
     }
// for (let i = 0; i < 5; i++)
    //     .each(function(e) {
    //     console.log("> ",e, typeof(e), $( this )[0].children);
    //     // $( this )[0].style.height="200px";
    //     let scl = 
    //     $( this )[0].children[0].width = 500;
    //     $( this )[0].children[0].style.marginLeft = "-100px";
    //     $( this )[0].children[0].style.marginTop = (-100).toString()+"px";
    //     console.log("> ",e, typeof(e), $( this )[0].children);
    // })
  });
});